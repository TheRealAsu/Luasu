-- LuasuV1.5

--[[
    Version: LuasuV1.5 [PREVIEW ONLY]

    Made by:
    -   @thereal_asu


    Note:
    -   if you're here, it's probably to get some code so don't forget to
        credit me if you take code from here to make a script related to bots please :)
        Have fun making sense of all this mess


    Tip: ctrl + F to search for what you need

    Summary:

        KEYWORD                      INFO

    -   Global Services              | Service Roblox used for bots and Owner
    -   Global variables             | Variables used by bots and owner
    -   Global Functions             | Functions Variables used by bots and owner
    -   Main Script                  | where the script differentiates between a "bot" instance and an "Owner" instance and distributes 2 different scripts
    -   GlobalTab                    |
    -   UsualTab                     |
    -   FunnyTab                     |
    -   MiscTab                      |
    -   OffensiveTab                 |
    -   CommunicationTab             |
    -   OtherTab                     |
    -   ShapeTab                     |
    -   HelpTab                      |
    -   AboutTab                     |
    -   BOT PART                     | where the bot script part of the script begins
    -   FINAL END                    | The end of the 'Main Script'
    -   COMMANDS ID                  | all command IDs
    -   Bot services                 |
    -   Bot variables                |
    -   Bot functions                |
    -   TOKEN                        | to differentiate commands
    -   LISTEN TO EXECUTOR VARIABLES | the part of the bots' script that listens to the commands sent by the Owner
    -   Command controller           | the place where the bot will execute functions based on commands
    -   
    -   
                    UNFINISHED


]]

-- Global Services
local VirtualUser = game:GetService("VirtualUser")

-- Global variables
local player = game.Players.LocalPlayer
local connection

Xeno.SetGlobal("__cmd", { 
    ["Idcmd"] = "Idcmd_data",
    ["Token"] = "Token_data",
    ["arg1"] = nil
})

local IDcommands = { -- COMMANDS ID, don't ask me why i used IDs instead of maybe doing something simpler, but I wanted to give it a try
    status = 0001, index = 0002, admin = 0003, undamin = 0004, quit = 0005, set = 0006, prefix = 0007, fix = 0008, fps = 0009, 
    ["anti-afk"] = 0010, collision = 0011, follow = 0012, unfollow = 0013, ["goto"] = 0014, dance = 0015, ws = 0016, reset = 0017, 
    jump = 0018, undance = 0019, orbit = 0020, orbit2 = 0021, orbit3 = 0022, orbit4 = 0023, orbit5 = 0024, orbit6 = 0025, orbit7 = 0026, 
    orbit8 = 0027, orbit9 = 0028, unorbit = 0029, fling = 0030, rocket = 0031, worm = 0032, unworm = 0033, spin = 0034, unspin = 0035, 
    fans = 0036, unfans = 0037, clone = 0038, unclone = 0039, tower = 0040, untower = 0041, stalk = 0042, unstalk = 0043, sayfps = 0044, 
    channel = 0045, say = 0046, botrender = 0047, loopjump = 0048, unloopjump = 0049, press = 0050, surround = 0051, arch = 0052, 
    wcircle = 0053, walign = 0054, warch = 0055, wings = 0056, circle = 0057, align = 0058, atomize = 0059, freaky = 0060, 
    unfreaky = 0061, bang = 0062, gbang = 0063, unbang = 0064, ungbang = 0065
}

local folderName = "LuasuV1.5"
local fileName = game.Players.LocalPlayer.Name
local filePath = folderName .. "/" .. fileName

if isfolder(folderName) then --so the folder is reseted
    delfolder(folderName)
end

-- flip the table, thanks for the tip 
local commandsByID = {}
for cmd, id in pairs(IDcommands) do
    commandsByID[id] = cmd
end

-- Global Functions
local function getcmdID(command)
    return IDcommands[command] or "no cmd"
end

local function getcmdfromID(id)
    return commandsByID[id] or "no id"
end

local function enableAntiAFK()
    if not connection then
    print("anti-afk ON")
        connection = player.Idled:Connect(function()
            if getgenv().afk6464 then
                VirtualUser:CaptureController()
                VirtualUser:ClickButton2(Vector2.new())
            end
        end)
    end
end

local function disableAntiAFK()
    if connection then
        connection:Disconnect()
        connection = nil
        print("Anti-AFK OFF")
    end
end

local function loop()
    while true do
        if getgenv().afk6464 then
            enableAntiAFK()
        else
            disableAntiAFK()
        end
        wait(1)
    end
end

-- Main Script
if game.Players.LocalPlayer.Name == getgenv().Owner then

--set up folder
wait(2.5)
if not isfolder(folderName) then
    makefolder(folderName)
end

--Interface
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "LuasuV1.5 bot controller [TEST VERSION]",
    LoadingTitle = "LuasuV1.5 bot controller [TEST VERSION]",
    LoadingSubtitle = "Made with ❤️ by @thereal_asu",
    ConfigurationSaving = {
       Enabled = false,
       FolderName = nil,
       FileName = "Big Hub"
    },
    Discord = {
       Enabled = false,
       Invite = "noinvitelink",
       RememberJoins = true
    },
    KeySystem = false,
    KeySettings = {
       Title = "Untitled",
       Subtitle = "Key System",
       Note = "No method of obtaining the key is provided",
       FileName = "Key",
       SaveKey = true,
       GrabKeyFromSite = false,
       Key = {"Hello"}
    }
 })

-- Tab before load
local GeneralTab = Window:CreateTab("General", 4483362458)

-- variables
loadGUI = true
local Fetching = true
local FetchingBotsNumber = 0
local bots = {}

--local Setcmd = Xeno.SetGlobal("__cmd") --f**k you
local Getcmd = Xeno.GetGlobal("__cmd")

-- functions
local function readLines(filePath)
    if not isfile(filePath) then
        return {}
    end

    local fileContent = readfile(filePath)
    return string.split(fileContent, "\n")
end

local function generateToken() -- TOKEN, to differentiate commands, so that they are not executed more than once
    local charset = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_"
    local tokenLength = 16
    local token = ""

    for i = 1, tokenLength do
        local randIndex = math.random(1, #charset)
        token = token .. charset:sub(randIndex, randIndex)
    end

    return token
end

local function LoadGUI() -- AFTER LOAD
    loadGUI = false -- make it so you can only load the interface once

-- GeneralTab
    local Section = GeneralTab:CreateSection("Bots") -- BOTS STATUS, INDEX

    for index, botName in pairs(bots) do
        local Label = GeneralTab:CreateLabel("User: "..botName .. " index: " .. index)
    end

    local Paragraph = GeneralTab:CreateParagraph({Title = "any issue ?", Content = "Execute the script again, wait a few seconds and press load again. Problem still persists? close your executor, re-open it and run the script"})
    local Section = GeneralTab:CreateSection("For Main Instance")
    local Button = GeneralTab:CreateButton({
        Name = "Load Infinite Yield",
        Callback = function()
            loadstring(game:HttpGet('https://raw.githubusercontent.com/edgeiy/infiniteyield/master/source'))()
    end,
    })

    local Toggle = GeneralTab:CreateToggle({
        Name = "Anti-AFK",
        CurrentValue = false,
        Flag = "Toggle1",
        Callback = function(Value)
            spawn(loop)
            getgenv().afk6464 = Value
        end,
     })

--tabs after load
    local GlobalTab = Window:CreateTab("Global", 4483362458)
    local UsualTab = Window:CreateTab("Usual", 4483362458)
    local FunnyTab = Window:CreateTab("Funny", 4483362458)
    local MiscTab = Window:CreateTab("Misc", 4483362458)
    local OffensiveTab = Window:CreateTab("Offensive", 4483362458)
    local CommunicationTab = Window:CreateTab("Communication", 4483362458)
    local OtherTab = Window:CreateTab("Other", 4483362458)
    local ShapeTab = Window:CreateTab("Shape", 4483362458)
    local HelpTab = Window:CreateTab("Help", 4483362458)
    local AboutTab = Window:CreateTab("About", 4483362458)

--GlobalTab
    local Section = GlobalTab:CreateSection("Global")
    local Toggle = GlobalTab:CreateToggle({
        Name = "Anti-AFK",
        CurrentValue = false,
        Flag = "Toggle1",
        Callback = function(Value)
            local command = "anti-afk"
            local commandID = getcmdID(command)
            local AToken = generateToken()
            Xeno.SetGlobal("__cmd", {
                ["Idcmd"] = commandID,
                ["Token"] = AToken,
                ["arg1"] = Value
            })
        end,
     })

--UsualTab
local Section = UsualTab:CreateSection("Usual")
local Input = UsualTab:CreateInput({
    Name = "goto [plr]",
    PlaceholderText = "Player Name",
    RemoveTextAfterFocusLost = false,
    Callback = function(player)
        local command = "goto"
        local commandID = getcmdID(command)
        local AToken = generateToken()
        Xeno.SetGlobal("__cmd", {
            ["Idcmd"] = commandID,
            ["Token"] = AToken,
            ["arg1"] = player
        })
        print(player)
    end,
 })

--FunnyTab
--MiscTab
--OffensiveTab

--CommunicationTab
    local Section = CommunicationTab:CreateSection("Communication")
    local Input = CommunicationTab:CreateInput({
        Name = "Say",
        PlaceholderText = "Text",
        RemoveTextAfterFocusLost = false,
        Callback = function(Text)
            local command = "say"
            local commandID = getcmdID(command)
            local Token = generateToken()
            Xeno.SetGlobal("__cmd", {
                ["Idcmd"] = commandID,
                ["Token"] = Token,
                ["arg1"] = Text
            })
        end,
    })
--OtherTab
--ShapeTab
--HelpTab

--AboutTab
    local Section = AboutTab:CreateSection("Credit")
    local Label = AboutTab:CreateLabel("Original owner: @thereal_asu")
    local Section = AboutTab:CreateSection("Join the community!")
    local Button = AboutTab:CreateButton({
            Name = "Copy Discord",
            Callback = function()
            setclipboard("https://discord.gg/uGhnBu89SM")
        end,
    })
    local Section = AboutTab:CreateSection("Info")
    local Paragraph = AboutTab:CreateParagraph({Title = "About this script", Content = "This script is one of my projects that I'm taking time to make, I'm leaving it open source to allow people to check if this script is trusted, but also to let people learn the different techniques used in this script to do specific things. Please don't be a bad “skid” and credit me if you use this script to create your own bot script or something related to bot script. It's ok to copy and paste my work for your script or improve my script to your own style, to suggest different versions of it, but please respect me, respect my work and have fun."})
    
    getgenv().Luasu = true
end -- end of the load

-- GeneralTab before load
local Section = GeneralTab:CreateSection("General")
local Paragraph = GeneralTab:CreateParagraph({Title = "Please Read:", Content = "make sure your exploit has been injected into all bots Instance before pressing load. Only press 'load' when the counter indicates the number of bots you have"})
local BotFound = GeneralTab:CreateLabel("bot instance found: "..FetchingBotsNumber)
local Button = GeneralTab:CreateButton({
    Name = "Load",
    Callback = function()
        Fetching = false -- stop fetching bots instances
        if loadGUI == true then
        LoadGUI()      
        end
    end,
 })

 Rayfield:Notify({
    Title = "Hello "..player.Name,
    Content = "Make sure your exploit is injected into all your bots.",
    Duration = 4.9,
    Image = 4483362458,
    Actions = {
 },
 })

 wait(2)
 if isfolder(folderName) then
    for _, fileName in ipairs(listfiles(folderName)) do
        local name = fileName:match("([^/]+)$")
        table.insert(bots, name)
    end
else
    warn("Luasu | non-existent folder")
end

while Fetching do
    wait(0.1)
    BotFound:Set("bot instance found: "..#bots)
        local botindexTAABLE = {}
        for i, botName in ipairs(bots) do
            botindexTAABLE[tostring(i)] = botName
        end
        Xeno.SetGlobal("__Index", botindexTAABLE)
end


else -- BOT PART -- BOT PART -- BOT PART -- BOT PART -- BOT PART -- BOT PART -- BOT PART -- BOT PART -- BOT PART -- BOT PART -- BOT PART -- BOT PART

wait(4)
if not isfile(filePath) then
    writefile(filePath, " ")
end

if getgenv().Luasu == true then
    return
end

wait(5)

-- Bot services
local TextChatService = game:GetService("TextChatService")

-- Bot variables
local botIndexTable = Xeno.GetGlobal("__Index")
local BotIndex = nil

--Make life easier
local function findPlayerByName(partialName)
    print("partialName: "..tostring(partialName))
    local SpartialName = partialName and tostring(partialName) or "me"
    print("SpartialName"..SpartialName)
    if SpartialName == "me" then
        return game.Players:FindFirstChild(getgenv().Owner)
    end

    local bestMatch = nil
    local bestMatchScore = 0

    for _, plr in pairs(game.Players:GetPlayers()) do
        local nameMatch = plr.Name:lower():find(SpartialName:lower())
        local displayNameMatch = plr.DisplayName:lower():find(SpartialName:lower())

        if nameMatch or displayNameMatch then
            local score = (nameMatch and #SpartialName or 0) + (displayNameMatch and #SpartialName or 0)
            if score > bestMatchScore then
                bestMatchScore = score
                bestMatch = plr
            end
        end
    end

    return bestMatch
end
-- chatmessage
local function chatMessage(str)
    str = tostring(str)
    if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
        TextChatService.TextChannels.RBXGeneral:SendAsync(str)
    else
        ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(str, "All")
    end
end

-- removeVelocity
local function removeVelocity()
    for _, v in pairs(player.Character:GetDescendants()) do
        if v:IsA("BasePart") then
            v.Velocity = Vector3.new(0, 0, 0)
            v.RotVelocity = Vector3.new(0, 0, 0)
        elseif v:IsA("BodyVelocity") then
            v.Velocity = Vector3.new(0, 0, 0)
        elseif v:IsA("BodyAngularVelocity") then
            v.AngularVelocity = Vector3.new(0, 0, 0)
        elseif v:IsA("BodyPosition") then
            v.Position = v.Position
        elseif v:IsA("BodyGyro") then
            v.CFrame = v.CFrame
        end
    end
  end

-- goto
local function goto(targetPlayer)
    if not targetPlayer or not targetPlayer.Character then
      return
    end

    local targetHumanoidRootPart = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not targetHumanoidRootPart then
      return
    end

    if player and player.Character then
      local localHumanoidRootPart = player.Character:FindFirstChild("HumanoidRootPart")
      if localHumanoidRootPart then
        removeVelocity()
        localHumanoidRootPart.CFrame = targetHumanoidRootPart.CFrame + Vector3.new(0, 0, 0)
      end
    end
end

-- bot functions for the script
if type(botIndexTable) == "table" then
    for key, name in pairs(botIndexTable) do
        if name == player.Name then
            BotIndex = key
            break
        end
    end

    if BotIndex then
        chatMessage("Index: " .. BotIndex)
    end
end

--INITIALIZE
local function listentoOwner()
    local localToken = "autistic/acoustic"

    while true do
        wait(0.01)
        local Getcmd = Xeno.GetGlobal("__cmd") or {}
        local arg1 = Getcmd["arg1"] or ""
        local idcmd = Getcmd["Idcmd"]

        if Getcmd["Token"] ~= localToken then
            --print("new CMDD Detected!")
            localToken = Getcmd["Token"]

            if idcmd == 46 then -- say
                chatMessage(arg1)

            elseif idcmd == 10 then -- anti-afk
            getgenv().afk6464 = arg1
            spawn(loop)

            elseif idcmd == 14 then -- goto
            print("arg1: "..arg1)
            local targetPlayer = findPlayerByName(arg1)
            if targetPlayer then
              goto(targetPlayer)
            else
                warn("Player not Found: "..targetPlayer)
            end

            elseif idcmd == 0 then
            
            end
        end
    end
end

spawn(function() listentoOwner() end)
getgenv().Luasu = true

end -- FINAL END
